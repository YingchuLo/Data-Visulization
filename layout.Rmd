---
title: "Laying out multiple plots on a page"
author: "Yingchu Lo"
date: "4/3/2019"
output: html_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```

## Summary 

Objective: Want to know if placing an advertisement on 1st week would increase the likelihood of buying 

Background: 
1) There are 3 types of product: banana, apple, orange.
2) We placed an advertisement for product 1,2,3 on the 1st week.

x: From 1st to 10th week
y: Likelihood of buying

## Dataset
dimension: 150 * 3
column name:product, week, buyer
product(categorical): 1,2,3
week(discrete): 1-10 
buyer(boolean): 0 means non-buyer, 1 means buyer

```{r}
d0<-data.frame(product=c(sample(1:3,150,replace=T)),week=c(sample(1:10,150,replace=T)),buyer=c(sample(0:1,150,replace = T)))
```

## Import 3 Libraries
  packge - function
1)plyr   - ddply
2)ggplot2- ggplot
3)ggpubr - ggarrange
```{r}
library(plyr)
library(ggplot2)
library(ggpubr)
```

## Caculate likelihood of buyer for each product from 1st to 10th week
Group by: product,week 

```{r}
dfx<-ddply(d0,.(product,week),summarize,mean=round(mean(buyer),2))
```

## Error Example
r would see "product" as a continuous data, but actullay it is a categorical data. Thus we need to change column type into "factor."
```{r}
p1<-ggplot(dfx,aes(x=week, y=mean,colour=factor(product)))+
  geom_line()+
  geom_point()+
  ylab(label="Likelihood of Buy")+
  scale_x_continuous(breaks=seq(c(1:10)),limits = c(1,10))
```

## Change column type into "factor"

```{r}
dfx$product<-as.factor(dfx$product)
dfx$product<-factor(dfx$product,labels=c("banana","apple","orange"))
```

## Summary Plot
```{r}
p1<-ggplot(dfx,aes(x=week, y=mean,colour=product))+
  geom_line()+
  geom_point()+
  ylab(label="Likelihood of Buy")+
  scale_x_continuous(breaks=seq(c(1:10)),limits = c(1,10))
```

## Individual Plot
```{r}
p2<-ggplot(dfx,aes(x=week, y=mean,colour=product))+
  facet_wrap(~product,ncol = 2)+
  guides(colour="none")+
  theme()+
  geom_line()+
  geom_point()+
  ylab(label="Likelihood of Buy")+
  scale_x_continuous(breaks=seq(c(1:10)),limits = c(1,10))
```

## Multiple Plots on 1 page
Our result

```{r pressure, echo=FALSE}
ggarrange(p1,p2)
```










